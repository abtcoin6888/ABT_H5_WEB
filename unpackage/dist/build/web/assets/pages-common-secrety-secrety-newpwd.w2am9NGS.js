import{I as e,a as t,b as a,a2 as s,a3 as o,i as l,r as n,q as r,w as c,t as i,u as d,v as p,x as u,z as h,H as w,W as f}from"./index-CvJkP8r7.js";import{_ as m}from"./fui-icon.BbrID5X2.js";import{r as _}from"./uni-app.es.4grYzir1.js";import{_ as y}from"./fui-nav-bar.CZAK61wT.js";import{_ as g}from"./fui-button.BkeFLZEF.js";import{_ as v}from"./authPop.CwFbtQQB.js";import{_ as $}from"./alert.DkjAnFY_.js";import{u as b}from"./user.PBjN9YNI.js";import{_ as x}from"./_plugin-vue_export-helper.BCo6x5W8.js";import"./uni-popup.BKNKbknm.js";import"./uni-popup-dialog.jPMVSOx-.js";var k=0;const C=x({components:{[e.name]:e},data(){return{eye:[!0,!0,!0],active:0,newpwd:"",dpwd:"",repwd:"",step:0,title:this.$t("login.tip_t2"),ctxt:this.$t("login.cancel"),ftxt:this.$t("login.confirm"),content:"",codeType:""}},watch:{newpwd(e){this.step=this.checkPassword(e)}},computed:{...t(["userAccount","userTheme"])},methods:{...a(["userLogin"]),confirm(){1==k&&this.$mroute.switchIndex()},authResult(e){this.$refs.authPop.close(),s({title:this.$t("secrety.processing")}),b.changePwd({password:this.newpwd,repassword:this.repwd,oldpassword:this.dpwd,vcode:e,account:this.userAccount,type:this.$util.isEmailAccount(this.userAccount)?1:2}).then((e=>{if(o(),200!=e.code)return this.content=e.message,this.$refs.alert.open(),!1;this.ctxt="",this.content=this.$t("newpwd.changepwd_suc"),this.$refs.alert.open(),this.userLogin(!1),k=1}))},async open(){return!(this.dpwd.length<6)&&(3!=this.step?(this.content=this.$t("newpwd.enter_corpwd"),this.$refs.alert.open(),!1):this.newpwd!=this.repwd?(this.content=this.$t("newpwd.different_twice"),this.$refs.alert.open(),!1):this.newpwd===this.dpwd?(this.content=this.$t("newpwd.different"),this.$refs.alert.open(),!1):(s({title:"loading"}),this.$util.isEmailAccount(this.userAccount)?(e=await l.sendUnCodeEmail(this.userAccount),this.codeType=this.$t("login.email")):(e=await l.sendUnCodePhone(this.userAccount),this.codeType=this.$t("login.phone")),o(),void(200!=e.code?(this.content=e.message,this.$refs.alert.open()):this.$refs.authPop.open())));var e},close(){this.$refs.authPop.close()},checkPassword:e=>/^.{8,14}$/.test(e)?/\d/.test(e)?/[A-Z]/.test(e)?3:2:1:0}},[["render",function(e,t,a,s,o,l){const b=_(n("fui-icon"),m),x=_(n("fui-nav-bar"),y),k=w,C=i,P=f,j=_(n("fui-button"),g),z=_(n("authPop"),v),A=_(n("alert"),$);return d(),r(C,{class:"newPwd","data-theme":e.userTheme},{default:c((()=>[p(x,{statusBar:"",isFixed:"",isOccupy:"",zIndex:"9",background:"var(--background-primary)",color:"var(--content-primary)",title:e.$t("newpwd.page_title"),onLeftClick:t[0]||(t[0]=t=>e.$mroute.back())},{default:c((()=>[p(b,{name:"arrowleft",size:"56",color:"var(--content-primary)"})])),_:1},8,["title"]),p(C,{class:"newPwd-body"},{default:c((()=>[p(C,{class:"tips"},{default:c((()=>[p(k,{class:"font-12 color-warring"},{default:c((()=>[p(b,{name:"warning",size:"34",color:"var(--color-text-golden)"}),u(" "+h(e.$t("newpwd.tip_con")),1)])),_:1})])),_:1}),p(C,{class:"label-box"},{default:c((()=>[p(C,{class:"text-cell"},{default:c((()=>[p(k,{class:"font-12 color-gray"},{default:c((()=>[u(h(e.$t("newpwd.old_pwd")),1)])),_:1})])),_:1}),p(C,{class:"input-box"},{default:c((()=>[p(P,{modelValue:o.dpwd,"onUpdate:modelValue":t[1]||(t[1]=e=>o.dpwd=e),onFocus:t[2]||(t[2]=e=>o.active=1),onBlur:t[3]||(t[3]=e=>o.active=0),password:o.eye[0],type:"text",placeholder:this.$t("newpwd.enter_oldpwd"),"placeholder-class":"placeholder"},null,8,["modelValue","password","placeholder"]),p(b,{name:0==o.eye[0]?"visible":"invisible",size:"38",color:"var(--content-tertiary)",onClick:t[4]||(t[4]=e=>o.eye[0]=!o.eye[0])},null,8,["name"])])),_:1})])),_:1}),p(C,{class:"label-box"},{default:c((()=>[p(C,{class:"text-cell"},{default:c((()=>[p(k,{class:"font-12 color-gray"},{default:c((()=>[u(h(e.$t("newpwd.new_pwd")),1)])),_:1})])),_:1}),p(C,{class:"input-box"},{default:c((()=>[p(P,{modelValue:o.newpwd,"onUpdate:modelValue":t[5]||(t[5]=e=>o.newpwd=e),onFocus:t[6]||(t[6]=e=>o.active=2),onBlur:t[7]||(t[7]=e=>o.active=0),password:o.eye[1],type:"text",placeholder:this.$t("newpwd.enter_newpwd"),"placeholder-class":"placeholder"},null,8,["modelValue","password","placeholder"]),p(b,{name:0==o.eye[1]?"visible":"invisible",size:"38",color:"var(--content-tertiary)",onClick:t[8]||(t[8]=e=>o.eye[1]=!o.eye[1])},null,8,["name"])])),_:1})])),_:1}),p(C,{class:"label-box"},{default:c((()=>[p(C,{class:"text-cell"},{default:c((()=>[p(b,{name:o.step>=1?"check":"close",size:"30",color:"var(--content-tertiary)"},null,8,["name"]),p(k,{class:"font-12 color-gray ml-5"},{default:c((()=>[u(h(e.$t("newpwd.tip_c1")),1)])),_:1})])),_:1}),p(C,{class:"text-cell mt-5"},{default:c((()=>[p(b,{name:o.step>=2?"check":"close",size:"30",color:"var(--content-tertiary)"},null,8,["name"]),p(k,{class:"font-12 color-gray ml-5"},{default:c((()=>[u(h(e.$t("newpwd.tip_c2")),1)])),_:1})])),_:1}),p(C,{class:"text-cell mt-5"},{default:c((()=>[p(b,{name:o.step>=3?"check":"close",size:"30",color:"var(--content-tertiary)"},null,8,["name"]),p(k,{class:"font-12 color-gray ml-5"},{default:c((()=>[u(h(e.$t("newpwd.tip_c3")),1)])),_:1})])),_:1})])),_:1}),p(C,{class:"label-box"},{default:c((()=>[p(C,{class:"text-cell"},{default:c((()=>[p(k,{class:"font-12 color-gray"},{default:c((()=>[u(h(e.$t("newpwd.confirm_newpwd")),1)])),_:1})])),_:1}),p(C,{class:"input-box"},{default:c((()=>[p(P,{modelValue:o.repwd,"onUpdate:modelValue":t[9]||(t[9]=e=>o.repwd=e),onFocus:t[10]||(t[10]=e=>o.active=3),onBlur:t[11]||(t[11]=e=>o.active=0),password:o.eye[2],type:"text",placeholder:this.$t("newpwd.again_newpwd"),"placeholder-class":"placeholder"},null,8,["modelValue","password","placeholder"]),p(b,{name:0==o.eye[2]?"visible":"invisible",size:"38",color:"var(--content-tertiary)",onClick:t[12]||(t[12]=e=>o.eye[2]=!o.eye[2])},null,8,["name"])])),_:1})])),_:1}),p(C,{class:"label-button"},{default:c((()=>[p(j,{height:"78rpx",radius:"78rpx",size:"26",onClick:l.open,background:o.dpwd.length>5&&3==o.step?"var(--content-primary)":"var(--background-secondary)",color:o.dpwd.length>5&&3==o.step?"var(--background-primary)":"var(--content-tertiary)"},{default:c((()=>[u(h(e.$t("hand.confirm_t")),1)])),_:1},8,["onClick","background","color"])])),_:1})])),_:1}),p(z,{ref:"authPop",onCallback:l.authResult,title:o.codeType},null,8,["onCallback","title"]),p(A,{ref:"alert",ctxt:o.ctxt,ftxt:o.ftxt,title:o.title,onConfirm:l.confirm,content:o.content},null,8,["ctxt","ftxt","title","onConfirm","content"])])),_:1},8,["data-theme"])}],["__scopeId","data-v-4be02526"]]);export{C as default};
